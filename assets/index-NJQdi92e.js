import{_ as M}from"./index-CXupB9Mu.js";import{d as E,b1 as N,c as w,o as F,w as o,b as l,aI as $,aK as K,u as m,aD as V,h as c,aN as U,dc as I,aO as D,r as k,ay as S,k as T,t as R,b2 as W,au as j,m as i,aF as z}from"./index-DuSeLP2O.js";import{_ as B}from"./index-BKdEAPQW.js";import{_ as G}from"./index-VIHKlQnV.js";import"./index-BzkfvoRI.js";import"./index-Oupfp0tU.js";import"./index-BgvxhPgN.js";import"./virtual-list-CRnh5OqY.js";import"./index-DevatPPZ.js";import"./index-CL4AVeLh.js";import{E as L}from"./upload-Britqp8q.js";import"./progress-CW57Qzxn.js";import{E as O,a as P}from"./col-DPin1CZR.js";import{p as q,r as A,u as H}from"./index-BgAAIbUv.js";import"./isArrayLikeObject-D8-JhZDJ.js";import"./vuedraggable.umd-rVDiD-f6.js";const J=E({__name:"file-search",emits:["search"],setup(C,{emit:f}){const g=f,[a,b]=N({name:"",path:"",createNickname:""}),d=()=>{g("search",{...a})},_=()=>{b(),d()};return(v,e)=>{const t=K,n=$,r=P,u=V,h=O,y=D,x=B;return F(),w(x,{"body-style":{paddingBottom:"2px"}},{default:o(()=>[l(y,{"label-width":"72px",onKeyup:I(d,["enter"]),onSubmit:e[3]||(e[3]=U(()=>{},["prevent"]))},{default:o(()=>[l(h,{gutter:8},{default:o(()=>[l(r,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[l(n,{label:"文件名称"},{default:o(()=>[l(t,{clearable:"",modelValue:m(a).name,"onUpdate:modelValue":e[0]||(e[0]=p=>m(a).name=p),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[l(n,{label:"文件路径"},{default:o(()=>[l(t,{clearable:"",modelValue:m(a).path,"onUpdate:modelValue":e[1]||(e[1]=p=>m(a).path=p),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[l(n,{label:"上传人"},{default:o(()=>[l(t,{clearable:"",modelValue:m(a).createNickname,"onUpdate:modelValue":e[2]||(e[2]=p=>m(a).createNickname=p),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{lg:6,md:12,sm:12,xs:24},{default:o(()=>[l(n,{"label-width":"16px"},{default:o(()=>[l(u,{type:"primary",onClick:d},{default:o(()=>e[4]||(e[4]=[c("查询")])),_:1}),l(u,{onClick:_},{default:o(()=>e[5]||(e[5]=[c("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),ue=E({name:"SystemFile",__name:"index",setup(C){const f=k(null),g=k([{type:"selection",columnKey:"selection",width:50,align:"center",fixed:"left"},{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"name",label:"文件名称",sortable:"custom",minWidth:140},{prop:"path",label:"文件路径",sortable:"custom",minWidth:140,slot:"path"},{prop:"length",label:"文件大小",width:120,align:"center",sortable:"custom",formatter:e=>e.length<1024?e.length+"B":e.length<1024*1024?(e.length/1024).toFixed(1)+"KB":e.length<1024*1024*1024?(e.length/1024/1024).toFixed(1)+"M":(e.length/1024/1024/1024).toFixed(1)+"G"},{prop:"createNickname",label:"上传人",width:120,align:"center",sortable:"custom"},{prop:"createTime",label:"上传时间",width:180,align:"center",sortable:"custom"},{columnKey:"action",label:"操作",width:120,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),a=k([]),b=({pages:e,where:t,orders:n})=>q({...t,...n,...e}),d=e=>{var t,n;a.value=[],(n=(t=f.value)==null?void 0:t.reload)==null||n.call(t,{page:1,where:e})},_=e=>{const t=e==null?a.value:[e];if(!t.length){i.error("请至少选择一条数据");return}z.confirm("确定要删除“"+t.map(n=>n.name).join(", ")+"”吗?","系统提示",{type:"warning",draggable:!0}).then(()=>{const n=i.loading({message:"请求中..",plain:!0});A(t.map(r=>r.id)).then(r=>{n.close(),i.success(r),d()}).catch(r=>{n.close(),i.error(r.message)})}).catch(()=>{})},v=e=>{if(e.size/1024/1024>100)return i.error("大小不能超过 100MB"),!1;const t=i.loading({message:"上传中..",plain:!0,mask:!0});return H(e).then(()=>{t.close(),i.success("上传成功"),d()}).catch(n=>{t.close(),i.error(n.message)}),!1};return(e,t)=>{const n=V,r=L,u=S,h=T,y=G,x=B,p=M;return F(),w(p,null,{default:o(()=>[l(J,{onSearch:d}),l(x,{"body-style":{paddingTop:"8px"}},{default:o(()=>[l(y,{ref_key:"tableRef",ref:f,"row-key":"id",columns:g.value,datasource:b,"show-overflow-tooltip":!0,selections:a.value,"onUpdate:selections":t[1]||(t[1]=s=>a.value=s),"highlight-current-row":!0,"export-config":{fileName:"文件数据"},"cache-key":"systemFileTable"},{toolbar:o(()=>[l(r,{action:"","show-file-list":!1,"before-upload":v,style:{display:"inline-block","vertical-align":"middle"}},{default:o(()=>[l(n,{type:"primary",class:"ele-btn-icon",icon:m(W)},{default:o(()=>t[2]||(t[2]=[c(" 上传 ")])),_:1},8,["icon"])]),_:1}),l(n,{type:"danger",class:"ele-btn-icon",icon:m(j),style:{"margin-left":"12px"},onClick:t[0]||(t[0]=s=>_())},{default:o(()=>t[3]||(t[3]=[c(" 删除 ")])),_:1},8,["icon"])]),path:o(({row:s})=>[l(u,{type:"primary",href:s.url,target:"_blank",underline:!1},{default:o(()=>[c(R(s.path),1)]),_:2},1032,["href"])]),action:o(({row:s})=>[l(u,{type:"primary",underline:!1,href:s.downloadUrl,target:"_blank"},{default:o(()=>t[4]||(t[4]=[c(" 下载 ")])),_:2},1032,["href"]),l(h,{direction:"vertical"}),l(u,{type:"danger",underline:!1,onClick:Q=>_(s)},{default:o(()=>t[5]||(t[5]=[c(" 删除 ")])),_:2},1032,["onClick"])]),_:1},8,["columns","selections"])]),_:1})]),_:1})}}});export{ue as default};
