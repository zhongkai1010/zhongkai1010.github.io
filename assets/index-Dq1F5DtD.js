import{_ as be}from"./index-BGEKHCwd.js";import{d as ee,b1 as ge,r as y,c as h,o as p,w as l,b as t,a5 as O,aI as ve,aK as ie,u as r,aD as te,h as _,ay as re,p as Y,e as s,E as de,be as xe,F as Z,bc as me,aN as T,dc as ye,aO as ke,b4 as oe,_ as ue,cv as he,n as pe,gx as Ve,aQ as we,aP as Ce,gy as Ee,a as ne,J as $e,gz as Ie,a_ as ze,s as Ne,a7 as se,t as D,k as Be,q as De,l as Te,ac as Se,aW as Ue,bR as Me,ar as Fe,at as Ke,bp as We,au as Re,U as Pe,aF as He,m as L}from"./index-BZ7jWUbG.js";import{_ as ce}from"./index-DCPMxH41.js";import{_ as Le}from"./index-DZ0GAEqR.js";import"./index-ffgvRswx.js";import"./index-C4Hsv7Kb.js";import"./index-CIzjM8Nz.js";import"./virtual-list-nakMouMI.js";import"./index-Dl3FPW19.js";import"./index-DG4sOXjS.js";import{_ as Oe}from"./index-CKi9WjUK.js";import{_ as Ye}from"./index-Co40oJrq.js";import{E as je,a as qe}from"./col-Bj5hMftQ.js";import{E as Ae}from"./date-picker-CMoOyU9F.js";import{p as Je,l as Qe}from"./index-D3_IVDYR.js";import"./isArrayLikeObject-CZ_BWLho.js";import"./vuedraggable.umd-Gmntv1Hm.js";import"./arrays-BMemeBNT.js";import"./index-CG0nmvOe.js";const Ge=ee({__name:"search-form",emits:["search"],setup(le,{emit:m}){const S=m,[i,E]=ge({username:"",organizationName:"",phone:"",email:""}),c=y(["",""]),b=y(!1),V=()=>{var u;const[w,n]=(u=c.value)!=null?u:[];S("search",{...i,createTimeStart:w?`${w} 00:00:00`:"",createTimeEnd:n?`${n} 23:59:59`:""})},g=()=>{E(),c.value=["",""],V()},k=()=>{b.value=!b.value};return(w,n)=>{const u=ie,d=ve,C=qe,j=Ae,K=te,U=de,q=re,W=je,A=ke,J=ce;return p(),h(J,{"body-style":{paddingBottom:"2px"}},{default:l(()=>[t(A,{"label-width":"72px",onKeyup:ye(V,["enter"]),onSubmit:n[5]||(n[5]=T(()=>{},["prevent"]))},{default:l(()=>[t(W,{gutter:8},{default:l(()=>[t(C,{lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{label:"用户账号"},{default:l(()=>[t(u,{clearable:"",modelValue:r(i).username,"onUpdate:modelValue":n[0]||(n[0]=v=>r(i).username=v),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),t(C,{lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{label:"组织机构"},{default:l(()=>[t(u,{clearable:"",modelValue:r(i).organizationName,"onUpdate:modelValue":n[1]||(n[1]=v=>r(i).organizationName=v),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),b.value?(p(),h(C,{key:0,lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{label:"手机号"},{default:l(()=>[t(u,{clearable:"",modelValue:r(i).phone,"onUpdate:modelValue":n[2]||(n[2]=v=>r(i).phone=v),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})):O("",!0),b.value?(p(),h(C,{key:1,lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{label:"邮箱"},{default:l(()=>[t(u,{clearable:"",modelValue:r(i).email,"onUpdate:modelValue":n[3]||(n[3]=v=>r(i).email=v),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1})):O("",!0),b.value?(p(),h(C,{key:2,lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{label:"创建时间"},{default:l(()=>[t(j,{"unlink-panels":"",type:"daterange",modelValue:c.value,"onUpdate:modelValue":n[4]||(n[4]=v=>c.value=v),"range-separator":"-","value-format":"YYYY-MM-DD","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"ele-fluid"},null,8,["modelValue"])]),_:1})]),_:1})):O("",!0),t(C,{lg:8,md:12,sm:12,xs:24},{default:l(()=>[t(d,{"label-width":"16px"},{default:l(()=>[t(K,{type:"primary",onClick:V},{default:l(()=>n[6]||(n[6]=[_("查询")])),_:1}),t(K,{onClick:g},{default:l(()=>n[7]||(n[7]=[_("重置")])),_:1}),t(q,{type:"primary",underline:!1,onClick:k,style:{"margin-left":"12px"}},{default:l(()=>[b.value?(p(),Y(Z,{key:0},[n[8]||(n[8]=s("span",null,"收起",-1)),t(U,{style:{"vertical-align":"-1px"}},{default:l(()=>[t(r(xe))]),_:1})],64)):(p(),Y(Z,{key:1},[n[9]||(n[9]=s("span",null,"展开",-1)),t(U,{style:{"vertical-align":"-2px"}},{default:l(()=>[t(r(me))]),_:1})],64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),Xe={style:{"margin-bottom":"12px"}},Ze={style:{"text-align":"right"}},et=ee({__name:"nickname-filter",emits:["search"],setup(le,{emit:m}){const S=m,i=y(""),E=y(!1),c=()=>{E.value=!!i.value,S("search",i.value)},b=()=>{i.value="",E.value=!1,c()};return(V,g)=>{const k=ue,w=ie,n=te,u=he;return p(),Y("div",{onClick:g[1]||(g[1]=T(()=>{},["stop"]))},[t(u,{width:200,trigger:"click",placement:"bottom-end","popper-options":{modifiers:[{name:"offset",options:{offset:[24,4]}}]}},{reference:l(()=>[t(k,{type:E.value?"primary":"placeholder",icon:r(oe),class:"demo-filter-icon"},null,8,["type","icon"])]),default:l(()=>[s("div",Xe,[t(w,{size:"small",modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=d=>i.value=d),placeholder:"请输入关键字",onChange:c},null,8,["modelValue"])]),s("div",Ze,[t(n,{size:"small",onClick:b},{default:l(()=>g[2]||(g[2]=[_("重置")])),_:1}),t(n,{size:"small",type:"primary",icon:r(oe),class:"ele-btn-icon",onClick:c},{default:l(()=>g[3]||(g[3]=[_(" 搜索 ")])),_:1},8,["icon"])])]),_:1})])}}}),tt=pe(et,[["__scopeId","data-v-ba5fbb00"]]),lt={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},at={style:{display:"flex","align-items":"center"}},ot={style:{flex:"1",overflow:"hidden","text-overflow":"ellipsis"}},nt={style:{"text-align":"center"}},st={style:{color:"red"}},it=ee({name:"ListBasic",__name:"index",setup(le){const{t:m}=Ve.useI18n(),{push:S}=we(),{addPageTab:i}=Ce(),[E]=Ee(["sex"]),c=y(null),b=y(""),V=ne({}),g=$e(()=>[{type:"selection",columnKey:"selection",width:50,align:"center",fixed:"left"},{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{columnKey:"avatar",prop:"avatar",label:m("list.basic.table.avatar"),width:100,align:"center",slot:"avatar",className:"demo-table-cell-avatar"},{prop:"username",label:m("list.basic.table.username"),minWidth:110,sortable:"custom"},{prop:"nickname",label:m("list.basic.table.nickname"),minWidth:110,sortable:"custom",headerSlot:"nicknameHeader"},{columnKey:"roles",label:m("list.basic.table.roles"),minWidth:110,slot:"roles",hideInTable:!0,formatter:a=>a.roles.map(e=>e.roleName).join(",")},{prop:"organizationName",label:m("list.basic.table.organizationName"),minWidth:110,sortable:"custom"},{prop:"phone",label:m("list.basic.table.phone"),minWidth:120,align:"center",sortable:"custom",hideInTable:!0},{prop:"email",label:m("list.basic.table.email"),minWidth:120,sortable:"custom",hideInTable:!0},{columnKey:"sex",prop:"sexName",label:m("list.basic.table.sexName"),width:110,align:"center",sortable:"custom",filters:E.value.map(a=>({text:a.dictDataName,value:a.dictDataCode})),filterMultiple:!1},{prop:"createTime",label:m("list.basic.table.createTime"),minWidth:200,align:"center",sortable:"custom"},{prop:"status",label:m("list.basic.table.status"),width:110,sortable:"custom",align:"center",slot:"status",filters:[{text:"正常",value:"0"},{text:"冻结",value:"1"}],filterMultiple:!1,formatter:a=>a.status==0?"正常":"冻结"},{columnKey:"action",label:m("list.basic.table.action"),width:130,align:"center",showOverflowTooltip:!1,resizable:!1,slot:"action",fixed:"right",hideInPrint:!0,hideInExport:!0}]),k=y([]),w=y(null),n=y(!0),u=y(!0),d=y(!1),C=({pages:a,where:e,orders:f,filters:$})=>Je({...e,...f,...$,...a}),j=()=>{Pe(()=>{var e,f;const a=[45,47,48];(f=(e=c.value)==null?void 0:e.setSelectedRowKeys)==null||f.call(e,a)})},K=a=>{Object.assign(V,a),v()},U=a=>{var e,f;(f=(e=c.value)==null?void 0:e.reload)==null||f.call(e,{page:1,where:a})},q=()=>{var a,e;(e=(a=c.value)==null?void 0:a.clearSelection)==null||e.call(a)},W=a=>{const e=a?`/list/basic/edit/${a.userId}`:"/list/basic/add";a&&i({title:`修改用户[${a.nickname}]`,key:e,closable:!0,meta:{icon:"LinkOutlined"}}),S(e)},A=a=>{He.confirm(`确定要删除“${a.username}”吗?`,"系统提示",{type:"warning",draggable:!0}).then(()=>{L.success("点击了删除")}).catch(()=>{})},J=a=>{a==="del"?L.error("点击了批量删除"):a==="edit"?L.info({message:"点击了批量修改",plain:!0}):a==="disabled"&&L.info({message:"点击了批量禁用",plain:!0})},v=()=>{b.value?U({...V,nickname:b.value}):U(V)},fe=a=>{b.value=a,v()},ae=({where:a,orders:e,filters:f})=>Qe({...a,...e,...f}),_e=ne({fileName:"基础列表数据",datasource:ae,beforeExport:a=>{const{fileName:e,closeModal:f,bodyCols:$,bodyData:Q,headerData:R}=a,M=Ie(a),I=M.getWorksheet("Sheet1");return(async()=>{const x=$.findIndex(F=>F.dataKey==="avatar");return I!=null&&x!==-1&&(await Promise.all(Q.map(async z=>{const N=z[x].text;return N?(await Ne({url:N,responseType:"arraybuffer"})).data:void 0}))).forEach((z,N)=>{const B=N+R.length;if(z!=null){const X=M.addImage({buffer:z,extension:"png"});I.addImage(X,{tl:{col:x+.4,row:B+.2},ext:{width:48,height:48}}),I.getCell(B+1,x+1).value=""}I.getRow(B+1).height=42,I.getColumn(x+1).width=8}),await M.xlsx.writeBuffer()})().then(x=>{ze(x,`${e}.xlsx`),f()}),!1}});return(a,e)=>{const f=ue,$=re,Q=Ye,R=te,M=de,I=Fe,P=Ue,x=Be,G=Se,F=Oe,z=Te,N=Le,B=ce,X=be;return p(),h(X,{"flex-table":d.value},{default:l(()=>[t(Ge,{onSearch:K}),t(B,{"flex-table":d.value,"body-style":{paddingBottom:"4px"},style:se({minHeight:d.value?"380px":void 0,marginBottom:d.value?"0px":void 0})},{default:l(()=>[t(Q,{"show-icon":"",closable:!1,style:se({marginBottom:u.value?"12px":"4px"})},{title:l(()=>[e[9]||(e[9]=s("span",null,"已选择 ",-1)),t(f,{strong:"",type:"primary",tag:"span"},{default:l(()=>[_(D(k.value.length),1)]),_:1}),e[10]||(e[10]=s("span",null," 项数据 ",-1)),e[11]||(e[11]=s("span",null,"其中冻结状态的用户有 ",-1)),s("b",null,D(k.value.filter(o=>o.status===1).length)+" 个  ",1),t($,{type:"primary",underline:!1,style:{"vertical-align":"0px"},onClick:q},{default:l(()=>e[8]||(e[8]=[_(" 清空 ")])),_:1})]),_:1},8,["style"]),t(N,{ref_key:"tableRef",ref:c,"row-key":"userId",columns:g.value,datasource:C,current:w.value,"onUpdate:current":e[6]||(e[6]=o=>w.value=o),selections:k.value,"onUpdate:selections":e[7]||(e[7]=o=>k.value=o),"show-overflow-tooltip":!0,"export-config":_e,"print-config":{datasource:ae},border:n.value,sticky:!d.value,toolbar:{theme:u.value?"default":"plain"},"default-sort":{prop:"createTime",order:"ascending"},"footer-style":{paddingBottom:"12px"},style:{"padding-bottom":"0"},class:"demo-table","cache-key":"listBasicTable",onDone:j},{toolbar:l(()=>[t(R,{type:"primary",icon:r(Me),class:"ele-btn-icon",onClick:e[0]||(e[0]=o=>W())},{default:l(()=>e[12]||(e[12]=[_(" 新建 ")])),_:1},8,["icon"]),t(I,{disabled:!k.value.length,items:[{title:"批量修改",command:"edit",icon:r(Ke)},{title:"批量禁用",command:"disabled",icon:r(We)},{title:"批量删除",command:"del",icon:r(Re),danger:!0,divided:!0}],"icon-props":{size:15},placement:"bottom-start",style:{"margin-left":"12px"},onCommand:J},{default:l(()=>[t(R,{disabled:!k.value.length,class:"ele-btn-icon"},{default:l(()=>[e[13]||(e[13]=s("span",null,"批量操作",-1)),t(M,{size:12,style:{margin:"0 -4px 0 2px"}},{default:l(()=>[t(r(me))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["disabled","items"])]),tools:l(()=>[s("div",lt,[e[14]||(e[14]=s("div",null,"边框 ",-1)),t(P,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),size:"small"},null,8,["modelValue"]),t(x,{direction:"vertical"}),e[15]||(e[15]=s("div",null,"表头背景 ",-1)),t(P,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=o=>u.value=o),size:"small"},null,8,["modelValue"]),t(x,{direction:"vertical"}),e[16]||(e[16]=s("div",null,"高度铺满 ",-1)),t(P,{modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=o=>d.value=o),size:"small"},null,8,["modelValue"]),t(x,{direction:"vertical"})])]),avatar:l(({row:o})=>[o.avatar?(p(),h(G,{key:0,src:o.avatar,size:32,onClick:e[4]||(e[4]=T(()=>{},["stop"])),style:{"vertical-align":"-16px"}},null,8,["src"])):(p(),h(G,{key:1,size:32,style:{background:"var(--el-color-primary)","vertical-align":"-2px"},onClick:e[5]||(e[5]=T(()=>{},["stop"]))},{default:l(()=>[_(D(o.nickname&&o.nickname.length>2?o.nickname.substring(o.nickname.length-2):o.nickname),1)]),_:2},1024))]),status:l(({row:o})=>[o.status===0?(p(),h(F,{key:0,text:"正常",size:"8px"})):o.status===1?(p(),h(F,{key:1,text:"冻结",type:"danger",ripple:!1,size:"8px"})):O("",!0)]),roles:l(({row:o})=>[(p(!0),Y(Z,null,De(o.roles,H=>(p(),h(z,{key:H.roleId,size:"small","disable-transitions":!0,style:{"margin-right":"6px"}},{default:l(()=>[_(D(H.roleName),1)]),_:2},1024))),128))]),action:l(({row:o})=>[t($,{type:"primary",underline:!1,onClick:T(H=>W(o),["stop"])},{default:l(()=>e[17]||(e[17]=[_(" 修改 ")])),_:2},1032,["onClick"]),t(x,{direction:"vertical"}),t($,{type:"danger",underline:!1,onClick:T(H=>A(o),["stop"])},{default:l(()=>e[18]||(e[18]=[_(" 删除 ")])),_:2},1032,["onClick"])]),nicknameHeader:l(({column:o})=>[s("div",at,[s("div",ot,D(o.label),1),t(tt,{onSearch:fe})])]),printTop:l(()=>e[19]||(e[19]=[s("h2",{style:{"text-align":"center"}},"还可以自定义打印的顶部区域",-1)])),printBottom:l(({data:o})=>[e[22]||(e[22]=s("h2",{style:{"text-align":"center"}},"还可以自定义打印的底部区域",-1)),s("div",nt,[e[20]||(e[20]=_(" 共打印了 ")),s("b",st,D(o.length),1),e[21]||(e[21]=_(" 条数据 "))])]),_:1},8,["columns","current","selections","export-config","print-config","border","sticky","toolbar"])]),_:1},8,["flex-table","style"])]),_:1},8,["flex-table"])}}}),$t=pe(it,[["__scopeId","data-v-b7ea2f98"]]);export{$t as default};
