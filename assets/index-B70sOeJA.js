import{_ as q}from"./index-BGEKHCwd.js";import{d as F,r as C,c as N,o as h,w as i,b as c,aY as K,aD as T,h as k,aZ as E,a_ as M,m as g,e as w,p as _,q as B,F as z,t as A,a5 as V}from"./index-BZ7jWUbG.js";import{_ as U}from"./index-DCPMxH41.js";import{_ as G}from"./index-DZ0GAEqR.js";import"./index-ffgvRswx.js";import"./index-C4Hsv7Kb.js";import"./index-CIzjM8Nz.js";import"./virtual-list-nakMouMI.js";import"./index-Dl3FPW19.js";import{_ as I}from"./index-DG4sOXjS.js";import{E as J}from"./upload-BQgRzgaa.js";import"./progress-DcnCiSdI.js";import"./isArrayLikeObject-CZ_BWLho.js";import"./vuedraggable.umd-Gmntv1Hm.js";const L=F({__name:"excel-export",setup($){const f=C([{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}]),b=C([{type:"selection",columnKey:"selection",width:56,align:"center"},{type:"index",columnKey:"index",width:56,align:"center"},{prop:"username",label:"用户名",align:"center",minWidth:110},{columnKey:"cityAddress",label:"地址",align:"center",children:[{prop:"province",label:"省",align:"center",minWidth:100},{prop:"city",label:"市",align:"center",minWidth:100},{prop:"zone",label:"区",align:"center",minWidth:120},{prop:"street",label:"街道",align:"center",minWidth:120},{prop:"address",label:"详细地址",align:"center",minWidth:160}]},{prop:"amount",label:"金额",align:"center",minWidth:80}]),v=C([]),W=()=>{const n=new E.Workbook,t=n.addWorksheet("Sheet1");t.addRow(["用户名","省","市","区","街道","详细地址","金额"]),f.value.forEach(e=>{t.addRow([e.username,e.province,e.city,e.zone,e.street,e.address,e.amount])}),[16,16,16,16,20,30,12].forEach((e,s)=>{t.getColumn(s+1).width=e}),t.eachRow({includeEmpty:!0},(e,s)=>{e.height=20,e.eachCell({includeEmpty:!0},r=>{r.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},r.alignment={vertical:"middle",horizontal:"center"},r.font={size:12,bold:s===1}})}),n.xlsx.writeBuffer().then(e=>{M(e,"用户数据.xlsx")})},S=()=>{const n=new E.Workbook,t=n.addWorksheet("Sheet1");t.addRow(["用户名","地址",null,null,null,null,"金额"]),t.addRow([null,"省","市","区","街道","详细地址",null]),f.value.forEach(e=>{t.addRow([e.username,e.province,e.city,e.zone,e.street,e.address,e.amount])}),[16,16,16,16,20,30,12].forEach((e,s)=>{t.getColumn(s+1).width=e}),t.eachRow({includeEmpty:!0},(e,s)=>{e.height=20,e.eachCell({includeEmpty:!0},r=>{r.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},r.alignment={vertical:"middle",horizontal:"center"},r.font={size:12,bold:s<3}})}),t.mergeCells(1,2,1,6),t.mergeCells(1,1,2,1),t.mergeCells(1,7,2,7),n.xlsx.writeBuffer().then(e=>{M(e,"用户数据.xlsx")})},u=()=>{if(v.value.length===0){g.error("请至少选择一条数据");return}const n=new E.Workbook,t=n.addWorksheet("Sheet1");t.addRow(["用户名","省","市","区","街道","详细地址","金额"]),v.value.forEach(e=>{t.addRow([e.username,e.province,e.city,e.zone,e.street,e.address,e.amount])}),[16,16,16,16,20,30,12].forEach((e,s)=>{t.getColumn(s+1).width=e}),t.eachRow({includeEmpty:!0},(e,s)=>{e.height=20,e.eachCell({includeEmpty:!0},r=>{r.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},r.alignment={vertical:"middle",horizontal:"center"},r.font={size:12,bold:s===1}})}),n.xlsx.writeBuffer().then(e=>{M(e,"用户数据.xlsx")})};return(n,t)=>{const e=T,s=K,r=G,a=U;return h(),N(a,{header:"导出 Excel","body-style":{padding:"18px 20px"}},{default:i(()=>[c(r,{"row-key":"key",columns:b.value,datasource:f.value,"show-overflow-tooltip":!0,pagination:!1,selections:v.value,"onUpdate:selections":t[0]||(t[0]=o=>v.value=o),tools:["export","print","size","columns","maximized"],toolbar:{theme:"default"},border:!0},{toolbar:i(()=>[c(s,{size:12,wrap:""},{default:i(()=>[c(e,{type:"primary",class:"ele-btn-icon",onClick:W},{default:i(()=>t[1]||(t[1]=[k(" 导出 ")])),_:1}),c(e,{type:"primary",class:"ele-btn-icon",onClick:S},{default:i(()=>t[2]||(t[2]=[k(" 导出带表头合并 ")])),_:1}),c(e,{type:"primary",class:"ele-btn-icon",onClick:u},{default:i(()=>t[3]||(t[3]=[k(" 导出选中 ")])),_:1})]),_:1})]),_:1},8,["columns","datasource","selections"])]),_:1})}}}),Y={style:{overflow:"auto","margin-top":"12px"}},Z={style:{"text-align":"center"}},j=["colspan","rowspan"],H={key:0},O=["colspan"],P=F({__name:"excel-import",setup($){const f=C(["A","B","C","D","E","F","G"]),b=C([]),v=u=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(u.type))return g.error("只能选择 excel 文件"),!1;if(u.size/1024/1024>20)return g.error("大小不能超过 20MB"),!1;const n=g.loading({message:"加载中..",plain:!0}),t=new FileReader;return t.onload=e=>{var r;const s=new E.Workbook;s.xlsx.load((r=e.target)==null?void 0:r.result).then(()=>{const a=[],o=[];s.eachSheet(x=>{o.splice(0,o.length),x.eachRow({includeEmpty:!0},(d,y)=>{a.splice(0,a.length);const l={};d.eachCell({includeEmpty:!0},p=>{const m=p.address.slice(0,-String(y).length);a.push(m);const R=p.isMerged&&p.address!==p.master.address;l[m]={value:R?"":p.value,colspan:1,rowspan:1}}),o.push(l)})}),f.value=a,b.value=o,n.close()})},t.readAsArrayBuffer(u),!1},W=u=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(u.type))return g.error("只能选择 excel 文件"),!1;if(u.size/1024/1024>20)return g.error("大小不能超过 20MB"),!1;const n=g.loading({message:"加载中..",plain:!0}),t=new FileReader;return t.onload=e=>{var r;const s=new E.Workbook;s.xlsx.load((r=e.target)==null?void 0:r.result).then(()=>{const a=[],o=[];s.eachSheet(x=>{o.splice(0,o.length),x.eachRow({includeEmpty:!0},(d,y)=>{a.splice(0,a.length);const l={};d.eachCell({includeEmpty:!0},p=>{const m=p.address.slice(0,-String(y).length);a.push(m),l[m]={value:p.value,colspan:1,rowspan:1}}),o.push(l)})}),f.value=a,b.value=o,n.close()})},t.readAsArrayBuffer(u),!1},S=u=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(u.type))return g.error("只能选择 excel 文件"),!1;if(u.size/1024/1024>20)return g.error("大小不能超过 20MB"),!1;const n=g.loading({message:"加载中..",plain:!0}),t=new FileReader;return t.onload=e=>{var r;const s=new E.Workbook;s.xlsx.load((r=e.target)==null?void 0:r.result).then(()=>{const a=[],o=[];s.eachSheet(x=>{o.splice(0,o.length),x.eachRow({includeEmpty:!0},d=>{a.splice(0,a.length);const y={};d.eachCell({includeEmpty:!0},l=>{const p=l.address.slice(0,-String(l.row).length);a.push(p);const m=l.isMerged&&l.address!==l.master.address;y[p]={value:l.value,colspan:m?0:1,rowspan:m?0:1}}),o.push(y)}),x.eachRow({includeEmpty:!0},d=>{d.eachCell({includeEmpty:!0},y=>{const l=y.master;if(y.isMerged&&y.address!==l.address){const p=l.address.slice(0,-String(l.row).length),m=o[Number(l.row)-1][p],R=Math.abs(Number(y.row)-Number(l.row))+1;R>m.rowspan&&(m.rowspan=R);const D=Math.abs(Number(y.col)-Number(l.col))+1;D>m.colspan&&(m.colspan=D)}})})}),f.value=a,b.value=o,n.close()})},t.readAsArrayBuffer(u),!1};return(u,n)=>{const t=T,e=J,s=K,r=I,a=U;return h(),N(a,{header:"导入 Excel"},{default:i(()=>[c(s,null,{default:i(()=>[c(e,{action:"",accept:".xls,.xlsx","show-file-list":!1,"before-upload":v},{default:i(()=>[c(t,{type:"primary",class:"ele-btn-icon"},{default:i(()=>n[0]||(n[0]=[k("导入")])),_:1})]),_:1}),c(e,{action:"",accept:".xls,.xlsx","show-file-list":!1,"before-upload":W},{default:i(()=>[c(t,{type:"primary",class:"ele-btn-icon"},{default:i(()=>n[1]||(n[1]=[k(" 导入拆分合并 ")])),_:1})]),_:1}),c(e,{action:"",accept:".xls,.xlsx","show-file-list":!1,"before-upload":S},{default:i(()=>[c(t,{type:"primary",class:"ele-btn-icon"},{default:i(()=>n[2]||(n[2]=[k(" 导入保持合并 ")])),_:1})]),_:1})]),_:1}),w("div",Y,[c(r,{border:!0,style:{"min-width":"max-content","table-layout":"fixed"}},{default:i(()=>[w("colgroup",null,[n[3]||(n[3]=w("col",{width:"52"},null,-1)),(h(!0),_(z,null,B(f.value,o=>(h(),_("col",{key:o}))),128))]),w("thead",null,[w("tr",null,[n[4]||(n[4]=w("th",null,null,-1)),(h(!0),_(z,null,B(f.value,o=>(h(),_("th",{key:o,style:{"text-align":"center"}},A(o),1))),128))])]),w("tbody",null,[(h(!0),_(z,null,B(b.value,(o,x)=>(h(),_("tr",{key:x},[w("td",Z,A(x+1),1),(h(!0),_(z,null,B(f.value,d=>(h(),_(z,null,[o[d].colspan!==0&&o[d].rowspan!==0?(h(),_("td",{key:d,colspan:o[d].colspan,rowspan:o[d].rowspan,style:{"text-align":"center"}},A(o[d].value),9,j)):V("",!0)],64))),256))]))),128)),b.value.length?V("",!0):(h(),_("tr",H,[w("td",{colspan:f.value.length+1,style:{"text-align":"center",background:"none"}}," 暂无数据 ",8,O)]))])]),_:1})])]),_:1})}}}),pe=F({name:"ExtensionExcel",__name:"index",setup($){return(f,b)=>{const v=q;return h(),N(v,null,{default:i(()=>[c(L),c(P)]),_:1})}}});export{pe as default};
