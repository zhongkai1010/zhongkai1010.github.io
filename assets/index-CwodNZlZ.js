import{d as T,r as S,R as z,p as b,o as B,a5 as F,a7 as D,e as O}from"./index-BZ7jWUbG.js";var U=Object.defineProperty,k=(d,l,r)=>l in d?U(d,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[l]=r,E=(d,l,r)=>k(d,typeof l!="symbol"?l+"":l,r),y;(d=>{const l=class c{constructor(t,s,e,o){if(E(this,"size"),E(this,"mask"),E(this,"modules",[]),E(this,"isFunction",[]),this.version=t,this.errorCorrectionLevel=s,t<c.MIN_VERSION||t>c.MAX_VERSION)throw"Version value out of range";if(o<-1||o>7)throw"Mask value out of range";this.size=t*4+17;let i=[];for(let n=0;n<this.size;n++)i.push(!1);for(let n=0;n<this.size;n++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const a=this.addEccAndInterleave(e);if(this.drawCodewords(a),o==-1){let n=1e9;for(let m=0;m<8;m++){this.applyMask(m),this.drawFormatBits(m);const u=this.getPenaltyScore();u<n&&(o=m,n=u),this.applyMask(m)}}h(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(t,s){const e=d.QrSegment.makeSegments(t);return c.encodeSegments(e,s)}static encodeBinary(t,s){const e=d.QrSegment.makeBytes(t);return c.encodeSegments([e],s)}static encodeSegments(t,s,e=1,o=40,i=-1,a=!0){if(!(c.MIN_VERSION<=e&&e<=o&&o<=c.MAX_VERSION)||i<-1||i>7)throw"Invalid value";let n,m;for(n=e;;n++){const M=c.getNumDataCodewords(n,s)*8,P=w.getTotalBits(t,n);if(P<=M){m=P;break}if(n>=o)throw"Data too long"}for(const M of[c.Ecc.MEDIUM,c.Ecc.QUARTILE,c.Ecc.HIGH])a&&m<=c.getNumDataCodewords(n,M)*8&&(s=M);let u=[];for(const M of t){f(M.mode.modeBits,4,u),f(M.numChars,M.mode.numCharCountBits(n),u);for(const P of M.getData())u.push(P)}h(u.length==m);const R=c.getNumDataCodewords(n,s)*8;h(u.length<=R),f(0,Math.min(4,R-u.length),u),f(0,(8-u.length%8)%8,u),h(u.length%8==0);for(let M=236;u.length<R;M^=253)f(M,8,u);let A=[];for(;A.length*8<u.length;)A.push(0);return u.forEach((M,P)=>A[P>>>3]|=M<<7-(P&7)),new c(n,s,A,i)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let e=0;e<s;e++)for(let o=0;o<s;o++)e==0&&o==0||e==0&&o==s-1||e==s-1&&o==0||this.drawAlignmentPattern(t[e],t[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let e=s;for(let i=0;i<10;i++)e=e<<1^(e>>>9)*1335;const o=(s<<10|e)^21522;h(o>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,C(o,i));this.setFunctionModule(8,7,C(o,6)),this.setFunctionModule(8,8,C(o,7)),this.setFunctionModule(7,8,C(o,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,C(o,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,C(o,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,C(o,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let e=0;e<12;e++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;h(s>>>18==0);for(let e=0;e<18;e++){const o=C(s,e),i=this.size-11+e%3,a=Math.floor(e/3);this.setFunctionModule(i,a,o),this.setFunctionModule(a,i,o)}}drawFinderPattern(t,s){for(let e=-4;e<=4;e++)for(let o=-4;o<=4;o++){const i=Math.max(Math.abs(o),Math.abs(e)),a=t+o,n=s+e;0<=a&&a<this.size&&0<=n&&n<this.size&&this.setFunctionModule(a,n,i!=2&&i!=4)}}drawAlignmentPattern(t,s){for(let e=-2;e<=2;e++)for(let o=-2;o<=2;o++)this.setFunctionModule(t+o,s+e,Math.max(Math.abs(o),Math.abs(e))!=1)}setFunctionModule(t,s,e){this.modules[s][t]=e,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,e=this.errorCorrectionLevel;if(t.length!=c.getNumDataCodewords(s,e))throw"Invalid argument";const o=c.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][s],i=c.ECC_CODEWORDS_PER_BLOCK[e.ordinal][s],a=Math.floor(c.getNumRawDataModules(s)/8),n=o-a%o,m=Math.floor(a/o);let u=[];const R=c.reedSolomonComputeDivisor(i);for(let M=0,P=0;M<o;M++){let v=t.slice(P,P+m-i+(M<n?0:1));P+=v.length;const L=c.reedSolomonComputeRemainder(v,R);M<n&&v.push(0),u.push(v.concat(L))}let A=[];for(let M=0;M<u[0].length;M++)u.forEach((P,v)=>{(M!=m-i||v>=n)&&A.push(P[M])});return h(A.length==a),A}drawCodewords(t){if(t.length!=Math.floor(c.getNumRawDataModules(this.version)/8))throw"Invalid argument";let s=0;for(let e=this.size-1;e>=1;e-=2){e==6&&(e=5);for(let o=0;o<this.size;o++)for(let i=0;i<2;i++){const a=e-i,m=(e+1&2)==0?this.size-1-o:o;!this.isFunction[m][a]&&s<t.length*8&&(this.modules[m][a]=C(t[s>>>3],7-(s&7)),s++)}}h(s==t.length*8)}applyMask(t){if(t<0||t>7)throw"Mask value out of range";for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){let o;switch(t){case 0:o=(e+s)%2==0;break;case 1:o=s%2==0;break;case 2:o=e%3==0;break;case 3:o=(e+s)%3==0;break;case 4:o=(Math.floor(e/3)+Math.floor(s/2))%2==0;break;case 5:o=e*s%2+e*s%3==0;break;case 6:o=(e*s%2+e*s%3)%2==0;break;case 7:o=((e+s)%2+e*s%3)%2==0;break;default:throw"Unreachable"}!this.isFunction[s][e]&&o&&(this.modules[s][e]=!this.modules[s][e])}}getPenaltyScore(){let t=0;for(let i=0;i<this.size;i++){let a=!1,n=0,m=[0,0,0,0,0,0,0];for(let u=0;u<this.size;u++)this.modules[i][u]==a?(n++,n==5?t+=c.PENALTY_N1:n>5&&t++):(this.finderPenaltyAddHistory(n,m),a||(t+=this.finderPenaltyCountPatterns(m)*c.PENALTY_N3),a=this.modules[i][u],n=1);t+=this.finderPenaltyTerminateAndCount(a,n,m)*c.PENALTY_N3}for(let i=0;i<this.size;i++){let a=!1,n=0,m=[0,0,0,0,0,0,0];for(let u=0;u<this.size;u++)this.modules[u][i]==a?(n++,n==5?t+=c.PENALTY_N1:n>5&&t++):(this.finderPenaltyAddHistory(n,m),a||(t+=this.finderPenaltyCountPatterns(m)*c.PENALTY_N3),a=this.modules[u][i],n=1);t+=this.finderPenaltyTerminateAndCount(a,n,m)*c.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let a=0;a<this.size-1;a++){const n=this.modules[i][a];n==this.modules[i][a+1]&&n==this.modules[i+1][a]&&n==this.modules[i+1][a+1]&&(t+=c.PENALTY_N2)}let s=0;for(const i of this.modules)s=i.reduce((a,n)=>a+(n?1:0),s);const e=this.size*this.size,o=Math.ceil(Math.abs(s*20-e*10)/e)-1;return h(0<=o&&o<=9),t+=o*c.PENALTY_N4,h(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let e=[6];for(let o=this.size-7;e.length<t;o-=s)e.splice(1,0,o);return e}}static getNumRawDataModules(t){if(t<c.MIN_VERSION||t>c.MAX_VERSION)throw"Version number out of range";let s=(16*t+128)*t+64;if(t>=2){const e=Math.floor(t/7)+2;s-=(25*e-10)*e-55,t>=7&&(s-=36)}return h(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(c.getNumRawDataModules(t)/8)-c.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*c.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw"Degree out of range";let s=[];for(let o=0;o<t-1;o++)s.push(0);s.push(1);let e=1;for(let o=0;o<t;o++){for(let i=0;i<s.length;i++)s[i]=c.reedSolomonMultiply(s[i],e),i+1<s.length&&(s[i]^=s[i+1]);e=c.reedSolomonMultiply(e,2)}return s}static reedSolomonComputeRemainder(t,s){let e=s.map(o=>0);for(const o of t){const i=o^e.shift();e.push(0),s.forEach((a,n)=>e[n]^=c.reedSolomonMultiply(a,i))}return e}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw"Byte out of range";let e=0;for(let o=7;o>=0;o--)e=e<<1^(e>>>7)*285,e^=(s>>>o&1)*t;return h(e>>>8==0),e}finderPenaltyCountPatterns(t){const s=t[1];h(s<=this.size*3);const e=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(e&&t[0]>=s*4&&t[6]>=s?1:0)+(e&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,e){return t&&(this.finderPenaltyAddHistory(s,e),s=0),s+=this.size,this.finderPenaltyAddHistory(s,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};E(l,"MIN_VERSION",1),E(l,"MAX_VERSION",40),E(l,"PENALTY_N1",3),E(l,"PENALTY_N2",3),E(l,"PENALTY_N3",40),E(l,"PENALTY_N4",10),E(l,"ECC_CODEWORDS_PER_BLOCK",[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]]),E(l,"NUM_ERROR_CORRECTION_BLOCKS",[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]);let r=l;d.QrCode=r;function f(N,t,s){if(t<0||t>31||N>>>t)throw"Value out of range";for(let e=t-1;e>=0;e--)s.push(N>>>e&1)}function C(N,t){return(N>>>t&1)!=0}function h(N){if(!N)throw"Assertion error"}const p=class g{constructor(t,s,e){if(this.mode=t,this.numChars=s,this.bitData=e,s<0)throw"Invalid argument";this.bitData=e.slice()}static makeBytes(t){let s=[];for(const e of t)f(e,8,s);return new g(g.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!g.isNumeric(t))throw"String contains non-numeric characters";let s=[];for(let e=0;e<t.length;){const o=Math.min(t.length-e,3);f(Number.parseInt(t.substr(e,o),10),o*3+1,s),e+=o}return new g(g.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!g.isAlphanumeric(t))throw"String contains unencodable characters in alphanumeric mode";let s=[],e;for(e=0;e+2<=t.length;e+=2){let o=g.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e))*45;o+=g.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e+1)),f(o,11,s)}return e<t.length&&f(g.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e)),6,s),new g(g.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:g.isNumeric(t)?[g.makeNumeric(t)]:g.isAlphanumeric(t)?[g.makeAlphanumeric(t)]:[g.makeBytes(g.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw"ECI assignment value out of range";if(t<128)f(t,8,s);else if(t<16384)f(2,2,s),f(t,14,s);else if(t<1e6)f(6,3,s),f(t,21,s);else throw"ECI assignment value out of range";return new g(g.Mode.ECI,0,s)}static isNumeric(t){return g.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return g.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let e=0;for(const o of t){const i=o.mode.numCharCountBits(s);if(o.numChars>=1<<i)return 1/0;e+=4+i+o.bitData.length}return e}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let e=0;e<t.length;e++)t.charAt(e)!="%"?s.push(t.charCodeAt(e)):(s.push(Number.parseInt(t.substr(e+1,2),16)),e+=2);return s}};E(p,"NUMERIC_REGEX",/^[0-9]*$/),E(p,"ALPHANUMERIC_REGEX",/^[A-Z0-9 $%*+.\/:-]*$/),E(p,"ALPHANUMERIC_CHARSET","0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:");let w=p;d.QrSegment=w})(y||(y={}));(d=>{(l=>{const r=class{constructor(h,p){this.ordinal=h,this.formatBits=p}};E(r,"LOW",new r(0,1)),E(r,"MEDIUM",new r(1,0)),E(r,"QUARTILE",new r(2,3)),E(r,"HIGH",new r(3,2));let f=r;l.Ecc=f})(d.QrCode||(d.QrCode={}))})(y||(y={}));(d=>{(l=>{const r=class{constructor(h,p){this.modeBits=h,this.numBitsCharCount=p}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};E(r,"NUMERIC",new r(1,[10,12,14])),E(r,"ALPHANUMERIC",new r(2,[9,11,13])),E(r,"BYTE",new r(4,[8,16,16])),E(r,"KANJI",new r(8,[8,10,12])),E(r,"ECI",new r(7,[0,0,0]));let f=r;l.Mode=f})(d.QrSegment||(d.QrSegment={}))})(y||(y={}));const I=y,Q={L:I.QrCode.Ecc.LOW,M:I.QrCode.Ecc.MEDIUM,Q:I.QrCode.Ecc.QUARTILE,H:I.QrCode.Ecc.HIGH},H=.1,tt=function(){try{new Path2D().addPath(new Path2D)}catch(d){return!1}return!0}();function $(d,l,r,f){if(d==null||!d.src)return null;const C=f.length+r*2,h=Math.floor(l*H),p=C/l,w=(d.width||h)*p,N=(d.height||h)*p,t=d.x==null?f.length/2-w/2:d.x*p,s=d.y==null?f.length/2-N/2:d.y*p;let e=null;if(d.excavate){const o=Math.floor(t),i=Math.floor(s),a=Math.ceil(w+t-o),n=Math.ceil(N+s-i);e={x:o,y:i,w:a,h:n}}return{x:t,y:s,h:N,w,excavation:e}}function Y(d,l){return d.slice().map((r,f)=>f<l.y||f>=l.y+l.h?r:r.map((C,h)=>h<l.x||h>=l.x+l.w?C:!1))}function _(d,l=0){const r=[];return d.forEach(function(f,C){let h=null;f.forEach(function(p,w){if(!p&&h!==null){r.push(`M${h+l} ${C+l}h${w-h}v1H${h+l}z`),h=null;return}if(w===f.length-1){if(!p)return;h===null?r.push(`M${w+l},${C+l} h1v1H${w+l}z`):r.push(`M${h+l},${C+l} h${w+1-h}v1H${h+l}z`);return}p&&h===null&&(h=w)})}),r.join("")}const X={value:String,size:{type:Number,default:128},level:{type:String,default:"L"},bgColor:{type:String,default:"#FFFFFF"},fgColor:{type:String,default:"#000000"},margin:{type:Number,default:0},imageSettings:Object,customStyle:Object,tag:String},G={done:()=>!0},K={class:"ele-qr-code",style:{display:"inline-flex"}},W=["height","width","viewBox"],V=["fill","d"],j=["fill","d"],x=["xlink:href","height","width","x","y"],et=T({name:"EleQrCodeSvg",__name:"index",props:X,emits:G,setup(d,{emit:l}){const r=d,f=l,C=S(""),h=S(""),p=S(""),w=S(0),N=S(0),t=S(0),s=S(0),e=()=>{const{value:o,size:i,level:a,margin:n,imageSettings:m}=r;if(!o){C.value="";return}let u=I.QrCode.encodeText(o,Q[a]).getModules();const R=u.length+n*2,A=$(m,i,n,u);m!=null&&A!=null&&(A.excavation!=null&&(u=Y(u,A.excavation)),w.value=A.h,N.value=A.w,t.value=A.x+n,s.value=A.y+n),C.value=`0 0 ${R} ${R}`,h.value=`M0,0 h${R}v${R}H0z`,p.value=_(u,n),f("done")};return z([()=>r.value,()=>r.size,()=>r.level,()=>r.margin],()=>{e()},{immediate:!0}),z(()=>r.imageSettings,()=>{e()},{deep:!0}),(o,i)=>(B(),b("div",K,[C.value?(B(),b("svg",{key:0,shapeRendering:"crispEdges",height:o.size,width:o.size,viewBox:C.value,style:D(o.customStyle)},[O("path",{fill:o.bgColor,d:h.value},null,8,V),O("path",{fill:o.fgColor,d:p.value},null,8,j),o.imageSettings&&o.imageSettings.src?(B(),b("image",{key:0,"xlink:href":o.imageSettings.src,height:w.value,width:N.value,x:t.value,y:s.value,preserveAspectRatio:"none"},null,8,x)):F("",!0)],12,W)):F("",!0)]))}});export{Q as E,tt as S,et as _,X as a,I as b,_ as c,Y as e,$ as g,G as q};
