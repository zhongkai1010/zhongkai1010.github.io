import{a3 as _,_ as U,d as T,ao as I,c as N,B as k,r as n,T as j,o as w,b as G,U as q,u as c,f as E,w as d,i as L,l as oe,h as e,ap as O,e as re,C as de,y as S,k as V,E as K,__tla as ie}from"./index.35a750f6.js";import{e as se,R as $,c as ue,__tla as ne}from"./helps.76aab304.js";let P,pe=Promise.all([(()=>{try{return ie}catch{}})(),(()=>{try{return ne}catch{}})()]).then(async()=>{var C={getAllForms:()=>_.get({url:"/api/tools/form/getAllForms"}),getForm:r=>_.get({url:"/api/tools/form/getForm",params:{id:r}}),deleteForm:r=>_.post({url:"/api/tools/form/deleteForm",params:{id:r}}),saveForm:r=>_.post({url:"/api/tools/form/saveForm",data:r}),getFormFields:r=>_.get({url:"/api/tools/form/getFormFields",params:r}),saveField:r=>_.post({url:"/api/tools/form/saveField",data:r}),deleteField:r=>_.post({url:"/api/tools/form/deleteField",data:{id:r}})};const Z={class:"container"},z=["title"],D={key:0,class:"button"},H=T({name:"FormTree",props:{data:null},emits:["select","edit","remove"],setup(r,{expose:p,emit:f}){const v=r,{confirm:h}=S(),F=I(C.deleteForm),b=N(()=>[se(v.data)]),o=k([$]),s=k($),g=t=>{!t.isLeaf||(f("select",t),s.value=t.id,y(t))},i=t=>{h(`\u786E\u8BA4\u662F\u5426\u5220\u9664,"${t.displayName}"!`).then(async()=>{await F.execute(t.id),f("remove",t),y(t)})},y=t=>{t.group?o.value=[`${$}_${t.group}`]:o.value=[$]};return p({selectNode:g}),(t,a)=>{const l=n("iconify-icon"),u=n("el-tree"),x=j("loading");return w(),G("div",Z,[q((w(),E(u,{data:c(b),"highlight-current":"",onNodeClick:g,"default-expanded-keys":o.value,"node-key":"id",props:{label:"displayName"}},{default:d(({node:m})=>[L("div",{class:de(["tree-node",{"is-select":m.data.id==s.value}])},[L("span",{title:`${m.data.label}(${m.data.name})`},oe(m.label),9,z),m.isLeaf?(w(),G("div",D,[e(l,{icon:"ant-design:edit-outlined",class:"edit",onClick:O(B=>f("edit",m.data),["stop"])},null,8,["onClick"]),e(l,{icon:"ant-design:delete-outlined",class:"del",onClick:O(B=>i(m.data),["stop"])},null,8,["onClick"])])):re("",!0)],2)]),_:1},8,["data","default-expanded-keys"])),[[x,c(F).isFetching.value]])])}}});var J=U(H,[["__scopeId","data-v-7fb561c0"]]);const M=V(" \u7F16\u8F91 "),Q=V(" \u5220\u9664 "),W=T({name:"FormFieldGrid",props:{data:null},emits:["edit","remove","update"],setup(r,{emit:p}){const f=r,{confirm:v}=S(),h=N(()=>f.data),F=(s,g)=>{g.required=s,p("update",g)},b=s=>{v(`\u786E\u8BA4\u662F\u5426\u5220\u9664,"${s.label}"!`).then(async()=>{p("remove",s)})},o=s=>s+1;return(s,g)=>{const i=n("el-table-column"),y=n("el-switch"),t=n("el-button"),a=n("el-table");return w(),E(a,{rowKey:"id",data:c(h),stripe:""},{default:d(()=>[e(i,{type:"index",label:"\u5E8F\u53F7",width:"60",index:o}),e(i,{label:"\u6807\u7B7E",prop:"label","show-overflow-tooltip":!0}),e(i,{label:"\u5B57\u6BB5\u540D\u79F0",prop:"name"}),e(i,{label:"\u7EC4\u4EF6",prop:"component"}),e(i,{label:"\u9ED8\u8BA4\u503C",prop:"defaultValue"}),e(i,{label:"\u662F\u5426\u5FC5\u586B",prop:"required"},{default:d(l=>[e(y,{modelValue:l.row.required,"onUpdate:modelValue":u=>l.row.required=u,onChange:u=>F(u,l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(i,{label:"\u63CF\u8FF0",prop:"remark","show-overflow-tooltip":""}),e(i,{label:"\u6B65\u9AA4",prop:"setp"}),e(i,{label:"\u5206\u7EC4",prop:"group"}),e(i,{label:"\u6240\u5C5E\u7EC4\u7EC7",prop:"objectName"}),e(i,{prop:"operate",label:"\u64CD\u4F5C",align:"center"},{default:d(l=>[e(t,{link:"",type:"primary",onClick:u=>p("edit",l.row)},{default:d(()=>[M]),_:2},1032,["onClick"]),e(t,{link:"",type:"primary",onClick:u=>b(l.row)},{default:d(()=>[Q]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])}}}),X=V("\u521B\u5EFA"),Y=V(" \u8BBE\u8BA1\u8868\u5355 "),ee=T({name:"index",setup(r){const p=I(C.getFormFields),f=N({get:()=>{var a;return(a=p.data.value)!=null?a:[]},set:a=>{p.data.value=a}}),v=I(C.getAllForms,null,{immediate:!0}),h=I(C.getFormFields),F=k(),b=k(),o=k(),s=N(()=>o.value?`${o.value.displayName}(${o.value.name}) - \u8868\u5355\u5B57\u6BB5`:"\u8868\u5355\u5B57\u6BB5"),g=async a=>{var l;K("select form",a),((l=o.value)==null?void 0:l.id)!=a.id&&(o.value=a,await p.execute({formId:a.id,objectId:b.value}))},i=a=>{K("edit form",a)},y=async a=>{o.value&&await h.execute({formId:o.value.id,objectId:a})},t=a=>{const l=v.data.value.findIndex(u=>u.id==a.id);v.data.value.splice(l,1),(o==null?void 0:o.value.id)===a.id&&(f.value=[],o.value=null)};return(a,l)=>{const u=n("el-button"),x=n("CardTitle"),m=n("el-col"),B=n("FormSelectDictionary"),ae=n("el-row"),le=n("page-view"),R=j("loading");return q((w(),E(le,{class:"container",gutter:0,bgColor:!1},{default:d(()=>[e(ae,{gutter:20},{default:d(()=>[e(m,{span:4},{default:d(()=>[e(x,{title:"\u8868\u5355",icon:"carbon:model-alt"},{button:d(()=>[e(u,{type:"primary"},{default:d(()=>[X]),_:1})]),default:d(()=>{var A;return[q(e(J,{ref_key:"formTreeRef",ref:F,data:(A=c(v).data.value)!=null?A:[],onSelect:g,onEdit:l[0]||(l[0]=te=>i(te)),onRemove:t},null,8,["data"]),[[R,c(v).isFetching.value]])]}),_:1})]),_:1}),e(m,{span:20},{default:d(()=>[e(x,{title:c(s),icon:"carbon:property-relationship"},{button:d(()=>[e(B,{name:c(ue).ORGANIZATION,modelValue:b.value,"onUpdate:modelValue":l[1]||(l[1]=A=>b.value=A),style:{"margin-right":"5px"},placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7",clearable:"",onChange:y},null,8,["name","modelValue"]),e(u,{type:"primary"},{default:d(()=>[Y]),_:1})]),default:d(()=>[e(W,{data:c(f)},null,8,["data"])]),_:1},8,["title"])]),_:1})]),_:1})]),_:1})),[[R,c(p).isFetching.value]])}}});P=U(ee,[["__scopeId","data-v-3d6577f0"]])});export{pe as __tla,P as default};
