import{d as q,aZ as b,a_ as $,r as _,a$ as D,a as R,c as h,o as H,aB as J,w as t,b as a,aH as S,u as n,aJ as Z,cz as j,aM as A,aN as G,h as v,aC as K,m as N,U as y}from"./index-D0yT1AcU.js";import{E as L,a as P}from"./col-PPS4Xvy3.js";import{E as Q}from"./input-number-CopWbHXe.js";import{_ as W}from"./organization-select.vue_vue_type_script_setup_true_lang-4MY6zhcA.js";import{u as X,a as Y}from"./index-Bm75991C.js";const ne=q({__name:"organization-edit",props:b({data:{},organizationId:{},organizationData:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:b(["done"],["update:modelValue"]),setup(z,{emit:I}){const m=z,x=I,g=$(z,"modelValue"),u=_(!1),p=_(!1),f=_(null),[o,U,C]=D({organizationId:void 0,parentId:void 0,organizationName:"",organizationFullName:"",organizationCode:"",organizationType:void 0,sortNumber:void 0,comments:""}),E=R({organizationName:[{required:!0,message:"请输入机构名称",type:"string",trigger:"blur"}],organizationFullName:[{required:!0,message:"请输入机构全称",type:"string",trigger:"blur"}],organizationType:[{required:!0,message:"请选择机构类型",type:"string",trigger:"change"}],sortNumber:[{required:!0,message:"请输入排序号",type:"number",trigger:"blur"}]}),V=()=>{g.value=!1},F=()=>{var r,e;(e=(r=f.value)==null?void 0:r.validate)==null||e.call(r,i=>{if(!i)return;p.value=!0,(u.value?X:Y)({...o,parentId:o.parentId||0}).then(d=>{p.value=!1,N.success(d),V(),x("done")}).catch(d=>{p.value=!1,N.error(d.message)})})},w=()=>{m.data?(C({...m.data,parentId:m.data.parentId||void 0}),u.value=!0):(U(),o.parentId=m.organizationId,u.value=!1),y(()=>{y(()=>{var r,e;(e=(r=f.value)==null?void 0:r.clearValidate)==null||e.call(r)})})};return(r,e)=>{const i=S,s=Z,d=P,T=j,k=Q,M=L,O=G,c=K,B=J;return H(),h(B,{form:"",width:620,modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),title:u.value?"修改机构":"添加机构",onOpen:w},{footer:t(()=>[a(c,{onClick:V},{default:t(()=>e[9]||(e[9]=[v("取消")])),_:1}),a(c,{type:"primary",loading:p.value,onClick:F},{default:t(()=>e[10]||(e[10]=[v(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[a(O,{ref_key:"formRef",ref:f,model:n(o),rules:E,"label-width":"80px",onSubmit:e[7]||(e[7]=A(()=>{},["prevent"]))},{default:t(()=>[a(M,{gutter:16},{default:t(()=>[a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"上级机构",prop:"parentId"},{default:t(()=>[a(W,{modelValue:n(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>n(o).parentId=l),placeholder:"请选择上级机构","organization-data":r.organizationData},null,8,["modelValue","organization-data"])]),_:1}),a(i,{label:"机构名称",prop:"organizationName"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationName,"onUpdate:modelValue":e[1]||(e[1]=l=>n(o).organizationName=l),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构全称",prop:"organizationFullName"},{default:t(()=>[a(s,{clearable:"",maxlength:100,modelValue:n(o).organizationFullName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).organizationFullName=l),placeholder:"请输入机构全称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构代码"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationCode,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).organizationCode=l),placeholder:"请输入机构代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"机构类型",prop:"organizationType"},{default:t(()=>[a(T,{code:"organization_type",modelValue:n(o).organizationType,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).organizationType=l),placeholder:"请选择机构类型"},null,8,["modelValue"])]),_:1}),a(i,{label:"排序号",prop:"sortNumber"},{default:t(()=>[a(k,{min:0,max:99999,modelValue:n(o).sortNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).sortNumber=l),placeholder:"请输入排序号","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),a(i,{label:"备注"},{default:t(()=>[a(s,{rows:3,type:"textarea",maxlength:200,modelValue:n(o).comments,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).comments=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{ne as _};
