import{d as q,b0 as z,b1 as D,r as _,b2 as R,a as $,c as J,o as L,aD as P,w as t,b as a,aJ as S,u as n,aL as h,cB as j,aO as A,aP as G,i as v,aE as H,n as N,V as y}from"./index-Cam4GZdG.js";import{E as K,a as Q}from"./col-D5gd39Ri.js";import{E as W}from"./input-number-SA21_sAj.js";import{_ as X}from"./organization-select.vue_vue_type_script_setup_true_lang-DW4uazTC.js";import{u as Y,a as Z}from"./index-VMLaQo34.js";const ne=q({__name:"organization-edit",props:z({data:{},organizationId:{},organizationData:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:z(["done"],["update:modelValue"]),setup(V,{emit:I}){const u=V,x=I,g=D(V,"modelValue"),m=_(!1),p=_(!1),f=_(null),[o,E,U]=R({organizationId:void 0,parentId:void 0,organizationName:"",organizationFullName:"",organizationCode:"",organizationType:void 0,sortNumber:void 0,comments:""}),F=$({organizationName:[{required:!0,message:"请输入机构名称",type:"string",trigger:"blur"}],organizationFullName:[{required:!0,message:"请输入机构全称",type:"string",trigger:"blur"}],organizationType:[{required:!0,message:"请选择机构类型",type:"string",trigger:"change"}],sortNumber:[{required:!0,message:"请输入排序号",type:"number",trigger:"blur"}]}),b=()=>{g.value=!1},C=()=>{var r,e;(e=(r=f.value)==null?void 0:r.validate)==null||e.call(r,i=>{if(!i)return;p.value=!0,(m.value?Y:Z)({...o,parentId:o.parentId||0}).then(d=>{p.value=!1,N.success(d),b(),x("done")}).catch(d=>{p.value=!1,N.error(d.message)})})},w=()=>{u.data?(U({...u.data,parentId:u.data.parentId||void 0}),m.value=!0):(E(),o.parentId=u.organizationId,m.value=!1),y(()=>{y(()=>{var r,e;(e=(r=f.value)==null?void 0:r.clearValidate)==null||e.call(r)})})};return(r,e)=>{const i=S,s=h,d=Q,O=j,T=W,k=K,B=G,c=H,M=P;return L(),J(M,{form:"",width:620,modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),title:m.value?"修改机构":"添加机构",onOpen:w},{footer:t(()=>[a(c,{onClick:b},{default:t(()=>e[9]||(e[9]=[v("取消")])),_:1}),a(c,{type:"primary",loading:p.value,onClick:C},{default:t(()=>e[10]||(e[10]=[v(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[a(B,{ref_key:"formRef",ref:f,model:n(o),rules:F,"label-width":"80px",onSubmit:e[7]||(e[7]=A(()=>{},["prevent"]))},{default:t(()=>[a(k,{gutter:16},{default:t(()=>[a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"上级机构",prop:"parentId"},{default:t(()=>[a(X,{modelValue:n(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=l=>n(o).parentId=l),placeholder:"请选择上级机构","organization-data":r.organizationData},null,8,["modelValue","organization-data"])]),_:1}),a(i,{label:"机构名称",prop:"organizationName"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationName,"onUpdate:modelValue":e[1]||(e[1]=l=>n(o).organizationName=l),placeholder:"请输入机构名称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构全称",prop:"organizationFullName"},{default:t(()=>[a(s,{clearable:"",maxlength:100,modelValue:n(o).organizationFullName,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).organizationFullName=l),placeholder:"请输入机构全称"},null,8,["modelValue"])]),_:1}),a(i,{label:"机构代码"},{default:t(()=>[a(s,{clearable:"",maxlength:20,modelValue:n(o).organizationCode,"onUpdate:modelValue":e[3]||(e[3]=l=>n(o).organizationCode=l),placeholder:"请输入机构代码"},null,8,["modelValue"])]),_:1})]),_:1}),a(d,{sm:12,xs:24},{default:t(()=>[a(i,{label:"机构类型",prop:"organizationType"},{default:t(()=>[a(O,{code:"organization_type",modelValue:n(o).organizationType,"onUpdate:modelValue":e[4]||(e[4]=l=>n(o).organizationType=l),placeholder:"请选择机构类型"},null,8,["modelValue"])]),_:1}),a(i,{label:"排序号",prop:"sortNumber"},{default:t(()=>[a(T,{min:0,max:99999,modelValue:n(o).sortNumber,"onUpdate:modelValue":e[5]||(e[5]=l=>n(o).sortNumber=l),placeholder:"请输入排序号","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),a(i,{label:"备注"},{default:t(()=>[a(s,{rows:3,type:"textarea",maxlength:200,modelValue:n(o).comments,"onUpdate:modelValue":e[6]||(e[6]=l=>n(o).comments=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}});export{ne as _};
